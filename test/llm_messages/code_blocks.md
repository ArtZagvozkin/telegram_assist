# Создание Простого Telegram-Бота на Python: Пошаговое Руководство

Telegram-боты — это мощный инструмент для автоматизации задач, предоставления информации или даже создания мини-приложений прямо в популярном мессенджере. Написать своего первого бота на Python удивительно просто, особенно благодаря мощным библиотекам.

## H2: Подготовка Рабочей Среды

Прежде чем приступить к кодированию, нам нужно выполнить несколько подготовительных шагов.

### H3: Получение Токена Бота

Первый и самый важный шаг — регистрация вашего бота в Telegram.

1. **Найдите @BotFather:** Откройте Telegram и найдите официального бота `@BotFather`.
2. **Создайте нового бота:** Отправьте команду `/newbot`. Следуйте инструкциям, чтобы выбрать имя и уникальный *username* для вашего бота.
3. **Сохраните токен:** После успешного создания BotFather пришлет вам **токен доступа** (API Token). Это длинная строка, похожая на `123456789:ABC-DEF1234ghIkl-zyx57W2v1u123ew11`. Этот токен является ключом к управлению вашим ботом.

### H3: Установка Необходимой Библиотеки

Для взаимодействия с Telegram Bot API мы будем использовать одну из самых популярных библиотек — `python-telegram-bot`.

Откройте терминал или командную строку и выполните установку с помощью `pip`:

```bash
pip install python-telegram-bot
```

## H2: Написание Кода Первого Бота

Наш первый бот будет отвечать на команду `/start` и повторять любое текстовое сообщение, которое ему отправят (это называется *эхо-бот*).

### H3: Структура Файла `bot.py`

Создайте файл с именем `bot.py` и добавьте следующий код. Помните, что вам необходимо заменить `YOUR_TELEGRAM_BOT_TOKEN` на ваш реальный токен.

```python
import logging
from telegram import Update
from telegram.ext import Application, CommandHandler, MessageHandler, filters, ContextTypes

# Установим базовую настройку логирования
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s', level=logging.INFO
)
logger = logging.getLogger(__name__)

# Ваш токен, полученный от @BotFather
TOKEN = "YOUR_TELEGRAM_BOT_TOKEN"

# 1. Асинхронная функция-обработчик для команды /start
async def start_command(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """Отправляет приветственное сообщение при получении команды /start."""
    user = update.effective_user
    await update.message.reply_html(
        f"Привет, {user.mention_html()}! Я твой первый Python-бот. Попробуй отправить мне что-нибудь!",
    )

# 2. Асинхронная функция-обработчик для текстовых сообщений (эхо)
async def echo(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """Повторяет (эхо) сообщение пользователя."""
    await update.message.reply_text(update.message.text)

def main() -> None:
    """Запуск бота."""
    # Создаем объект Application и передаем ему токен
    application = Application.builder().token(TOKEN).build()

    # Регистрируем обработчики:
    # 1. Обработчик команды /start
    application.add_handler(CommandHandler("start", start_command))

    # 2. Обработчик всех текстовых сообщений (кроме команд)
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, echo))

    # Запускаем бота (начинаем опрос новых обновлений)
    logger.info("Бот запущен и слушает обновления...")
    application.run_polling(allowed_updates=Update.ALL_TYPES)

if __name__ == "__main__":
    main()
```

## H2: Запуск и Тестирование

После того как вы сохранили файл с вашим токеном, запуск бота максимально прост.

**Последовательность действий:**

1. **Откройте терминал** в директории, где сохранен файл `bot.py`.
2. **Запустите скрипт:**

```bash
python bot.py
```

Вы увидите в консоли сообщение: `Бот запущен и слушает обновления...`. Это означает, что ваш бот подключен к Telegram API и готов принимать сообщения.

3. **Протестируйте в Telegram:** Откройте Telegram, найдите своего бота по имени и отправьте ему `/start`. Затем отправьте любое слово или фразу. Бот должен **мгновенно** ответить тем же самым текстом.

## Краткий Вывод

Создание базового бота на Python сводится к трем основным шагам:

1. Получение **токена** через @BotFather.
2. Установка библиотеки `python-telegram-bot`.
3. Написание асинхронных функций-обработчиков (для команд `/start` и сообщений) и их регистрация в объекте `Application`, который затем запускается через `run_polling()`.